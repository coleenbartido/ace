
<head>
	<title>ACE Program | Reports </title>

	<link rel="stylesheet" type="text/css" href="css/admin/report.css">
</head>

<body>

<div>

	<div class="input-group">

					<div class="input-group-btn search-panel">
							<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
									<span id="search_concept">Search by</span>
									<span class="caret"></span>
							</button>
							<ul class="dropdown-menu" role="menu">
									<li><a href="javascript:void(0)" ng-click="changeFilterTo('sender_fullName')">Name</a></li>
									<li><a href="javascript:void(0)" ng-click="changeFilterTo('message_subject')">Subject</a></li>
							</ul>
					</div>

					<input type="text" class="form-control" ng-model="searchBox[myFilter]" placeholder="{{searchPlacholder}}">

		</div>

		<div class="dropdown">

			<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
		    	Select
		    	<span class="caret"></span>
			</button>
		</div>

		<div class="dropdown">

		  	<button class="btn btn-default dropdown-toggle" type="button" ng-disabled="disableActionBtn()" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
		    	Action
		    	<span class="caret"></span>
		  	</button>

		  	<ul class="dropdown-menu" aria-labelledby="dropdownMenu2">

					<li><a href="javascript:void(0)" ng-click="markAsRead()">Mark as read</a></li>
		    	<li><a href="javascript:void(0)" ng-click="markAsUnread()">Mark as unread</a></li>

					<li><a href="javascript:void(0)" ng-click="deleteReportList()">Delete</a></li>
		  	</ul>

		</div>

		<button class="btn btn-default" type="button" ng-click="initScope()">
		    Refresh
		</button>

		<table class="table table-bordered table-condensed table-striped table-condensed table-hover">
			<col width="20">
			<col width="60">
			<col width="120">			
			<col width="120">
			<col width="120">
			<col width="150">
			<col width="80">
			<col width="70">
				<thead>
					<tr>
						<th><center><input type="checkbox" ng-model="mainCheckbox" ng-change="controlCheckbox()"></center></th>
						<th>DATE</th>
						<th>SUBJECT</th>
						<th>REPORTED BY</th>						
						<th>NAME</th>
						<th>COURSE</th>
						<th>STATUS</th>
						<th><center>ACTION</center></th>
					</tr>
				</thead>
				<tbody>		
						<tr ng-repeat="report in reports | startFrom:(currentPage-1)*itemsPerPage | limitTo:itemsPerPage" data-toggle="modal" data-target="#viewModal" ng-click="viewReport(report)" ng-class="report.is_read == 1 ? 'info' : 'success'">
							<td>
								<center><input type="checkbox" data-checklist-model="reportList.report_id" data-checklist-value="report.report_id" checklist-change="updateMainCheckbox()" noclick></center>
							</td>
							<td>
								{{ report.report_date | date : "MMM d, yyyy"}}
							</td>
							<td>
								{{ report.subject_name }}
							</td>
							<td>
								{{ report.faculty_fname }} {{ report.faculty_lname }}
							</td>							
							<td>
								{{ report.student_fname }} {{ report.student_lname }}
							</td>
							<td>
								{{ report.program }}
							</td>
							<td>
								{{ report.report_status }}
							</td>
							<td>

								<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#messageModal" ng-click="createMessage(report)" noclick><span class="glyphicon glyphicon-pencil"></span></button>

								<button type="button" class="btn btn-primary" ng-click="deleteReport(report.report_id)" noclick><span class="glyphicon glyphicon-trash"></span></button>

							</td>
						</tr>

						<tr ng-show="(reports | filter:searchBox).length == 0">
							<td colspan="8"><center>NO RESULT</center></td>
						</tr>

				</tbody>
			</table>

			

			<div>
				<ul uib-pagination total-items="totalItems" ng-model="currentPage" items-per-page="itemsPerPage" max-size="maxSize" class="pagination-sm" boundary-links="true"></ul>
			</div>


			<!-- MESSAGE MODAL -->

			<div id="messageModal" class="modal draggable" role="dialog">
					<div class="modal-dialog">

						<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal"><span class="glyphicon glyphicon-remove custom-header-color" aria-hidden="true"></span></button>

									<p class="modal-title custom-header-color custom-modal-title">{{subject}}</p>
								</div>

								<div class="modal-body">

									<form name="messageFacultyForm" class="form-horizontal custom-form" role="form" ng-submit="sendEmail(selectedReport)" novalidate>

										<div class="form-group">
									        <label  class="col-md-12 control-label" for="receiver">To</label>
									        <div class="col-md-12">
												<input type="text" class="form-control" id="receiver" name="receiver" ng-model="receiver" required/>
									        </div>
									    </div>

									    <div class="form-group">
									        <label  class="col-md-12 control-label" for="composeEmail">Message</label>
									        <div class="col-md-12">										
												<textarea id="comment" rows="5" name="composeEmail" ng-model="composeEmail" placeholder="Write a message..."></textarea>
									        </div>
									    </div>
																		
										<div class="modalBtn">
									        <button type="submit" class="btn btn-primary">Send</button>
									    </div>

									</form>
								</div>

						</div>

					</div>
			</div><!-- modal closing tag -->


			<!-- VIEW REPORT -->

				<div id="viewModal" class="modal fade" role="dialog">
						<div class="modal-dialog">

							<div class="modal-content">
								<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal"><span class="glyphicon glyphicon-remove custom-header-color" aria-hidden="true"></span></button>
										<h4 class="modal-title custom-header-color">Report Details</h4>
								</div>
								<div class="modal-body">

											<p><b>Date: </b> {{ selectedReport.report_date | date : "MMMM d, yyyy"}}
											<p><b>Student ID Number: </b> {{ selectedReport.student_id }}
											<p><b>Level: </b> {{ selectedReport.level }}
											<p><b>Subject: </b> {{ selectedReport.subject_name }}
											<p><b>Name: </b> {{ selectedReport.student_fname }} {{ selectedReport.student_lname }}
											<p><b>Status </b> {{ selectedReport.report_status }}
											<p><b>Referred by: </b> {{ selectedReport.faculty_fname }} {{ selectedReport.faculty_lname }}
											<p><b>Course: </b> {{ selectedReport.program }}
											<p><b>Counselor's Note </b> {{ selectedReport.counselor_note }}
											<hr>
												<p><b>Referral Reason/s <b> {{ selectedReport.report_reasons}}
											<hr>
											
								</div>
								<div class="modal-footer">
										<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#noteModal" ng-click="showPopup(selectedReport)" data-dismiss="modal">Update Status</button>
										
								</div>
							</div>

						</div>
				</div><!-- modal closing tag -->


			<!-- COUNSELOR NOTES -->

				<div id="noteModal" class="modal fade" role="dialog">
						<div class="modal-dialog">

							<div class="modal-content">
								<div class="modal-header">
										<button type="button" class="close" data-dismiss="modal"><span class="glyphicon glyphicon-remove custom-header-color" aria-hidden="true"></span></button>
										<h4 class="modal-title custom-header-color">Update Report Status</h4>
								</div>
								<div class="modal-body">
									<form name="reportUpdateForm" class="form-horizontal custom-form" role="form" ng-submit="updateReportStatus(selectedReport)" novalidate>

										<div class="form-group">
								            <label  class="col-md-12 control-label" for="status">Report Status</label>
								            <div class="col-md-12">
								              <select class="form-control" name="status" id="status" ng-model="status" required>
												<option value="1">Uncounseled</option>
												<option value="2">In Progress</option>
												<option value="3">Counseled</option>
											  </select>
								            </div>
								        </div>
											
										<div class="form-group">
								            <label  class="col-md-12 control-label" for="comment">Counselor's Note</label>
								            <div class="col-md-12">
								              <textarea id="comment" rows="5" name="comment" ng-model="comment" placeholder="Write a comment..."></textarea>
								            </div>
								        </div>

								        <div class="modalBtn">
								            <button type="submit" class="btn btn-primary">Update</button>
								        </div>
											
									</form>
					
								</div>
									
							</div>

						</div>
				</div><!-- modal closing tag -->


</div>

</body>
